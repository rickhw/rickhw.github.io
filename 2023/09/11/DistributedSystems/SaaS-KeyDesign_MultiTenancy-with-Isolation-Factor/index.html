<!DOCTYPE HTML>
<head>
  <meta charset="utf-8">
  
  <title>SaaS 關鍵設計 - Multi-Tenancy - 探討真實世界的租賃關係 | Complete Think</title>

  <meta name="author" content="Rick Hwang">
  <meta name="description" content="多租戶架構 (Mulit-Tenancy Architecture, 以下稱作 MTA) 是 SaaS (Software as a Service, 軟體及服務) 設計的核心議題，也是我過去幾年工作研究的題目之一，大部分的人針對這個題目討論的多是 K8s 的 Namespace 劃分、或者資料庫的">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <!-- properties -->
  <meta property="og:title" content="SaaS 關鍵設計 - Multi-Tenancy - 探討真實世界的租賃關係"/>
  <meta property="og:site_name" content="Complete Think"/>
  <meta property="og:type"      content="website" />
  <meta property="og:url" content="https://rickhw.github.io/2023/09/11/DistributedSystems/SaaS-KeyDesign_MultiTenancy-with-Isolation-Factor/"/>
  <meta property="og:image" content="/images/DistributedSystems/MultiTenancy/lodger-landlord-rental-agreement_v20230911.png" />
  

  <!-- links -->
  <link rel="alternative" href="/atom.xml" title="Complete Think" type="application/atom+xml">
  <link href="/favicon.png" rel="icon">

  <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen" type="text/css">
  <!--
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap-theme.min.css">
  -->
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>

  <!-- analytics -->
  
<!--
<script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'G-74Y1F3F5W0']);
    _gaq.push(['_trackPageview']);

    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
</script>
-->
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-74Y1F3F5W0"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-74Y1F3F5W0');
</script>



  <!-- Facebook SDK -->
  <!-- ref: https://developers.facebook.com/docs/plugins/like-button -->
  <!-- @rickd 2022/02/24
    <div id="fb-root"></div>
    <script async defer crossorigin="anonymous"
      src="https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v3.2&appId=1554905741423841&autoLogAppEvents=1"></script>
  -->
  <!-- @ricka 2022/02/24 -->
  <!-- ref: https://developers.facebook.com/docs/plugins/like-button -->
  <!--
  <div id="fb-root"></div>
  <script async defer crossorigin="anonymous"
    src="https://connect.facebook.net/zh_TW/sdk.js#xfbml=1&version=v13.0&appId=1554905741423841&autoLogAppEvents=1"
    nonce="bd9r2mJp"></script>
  -->

  <!-- @ricka 2022/09/06 -->
  <!-- ref: https://developers.facebook.com/docs/plugins/like-button -->
  <div id="fb-root"></div>
  <script async defer crossorigin="anonymous"
    src="https://connect.facebook.net/zh_TW/sdk.js#xfbml=1&version=v14.0&appId=1554905741423841&autoLogAppEvents=1"
    nonce="opf2Gext"></script>


<meta name="generator" content="Hexo 6.1.0"></head>


<body>

  
<nav id="main-nav" class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
		<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
	  <a class="navbar-brand active" href="/">Complete Think</a>

      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  	
		  		
					<li class='dropdown'>
						<a aria-expanded='false' class='dropdown-toggle' data-toggle='dropdown' href='#' role='button'><i class="fa fa-folder"></i>Categories <span class='caret'/></span></a>
		            	<ul class='dropdown-menu' role='menu'>
		            	
						<li><a href="/categories/AWS/">AWS <sup>82</sup></a></li>
						
						<li><a href="/categories/About/">About <sup>29</sup></a></li>
						
						<li><a href="/categories/Blog/">Blog <sup>5</sup></a></li>
						
						<li><a href="/categories/經營管理/Career/">Career <sup>6</sup></a></li>
						
						<li><a href="/categories/Coding/">Coding <sup>10</sup></a></li>
						
						<li><a href="/categories/Computer-Science/">Computer Science <sup>6</sup></a></li>
						
						<li><a href="/categories/Container/">Container <sup>9</sup></a></li>
						
						<li><a href="/categories/Data/">Data <sup>2</sup></a></li>
						
						<li><a href="/categories/DevOps/">DevOps <sup>43</sup></a></li>
						
						<li><a href="/categories/Distributed-Systems/">Distributed Systems <sup>20</sup></a></li>
						
						<li><a href="/categories/GCP/">GCP <sup>8</sup></a></li>
						
						<li><a href="/categories/Linux/">Linux <sup>9</sup></a></li>
						
						<li><a href="/categories/Misc/">Misc <sup>3</sup></a></li>
						
						<li><a href="/categories/OS-X/">OS X <sup>4</sup></a></li>
						
						<li><a href="/categories/Redmine/">Redmine <sup>6</sup></a></li>
						
						<li><a href="/categories/Reference/">Reference <sup>5</sup></a></li>
						
						<li><a href="/categories/DevOps/SRE/">SRE <sup>25</sup></a></li>
						
						<li><a href="/categories/Software-Engineering/">Software Engineering <sup>10</sup></a></li>
						
						<li><a href="/categories/System-Design/">System Design <sup>2</sup></a></li>
						
						<li><a href="/categories/經營管理/人才管理/">人才管理 <sup>10</sup></a></li>
						
						<li><a href="/categories/經營管理/溝通/">溝通 <sup>9</sup></a></li>
						
						<li><a href="/categories/經營管理/知識管理/">知識管理 <sup>4</sup></a></li>
						
						<li><a href="/categories/經營管理/">經營管理 <sup>61</sup></a></li>
						
						<li><a href="/categories/軟體測試/">軟體測試 <sup>14</sup></a></li>
						
						</ul>
					</li>
		  		
		  	
		  		
		  			<li><a href="/2016/10/01/AWS-Study-Roadmap/" title="AWS Study Notes."><i class="fa fa-cloud"></i>AWS</a></li>
		  		
		  	
		  		
		  			<li><a href="/categories/DevOps/" title="DevOps / SRE"><i class="fa fa-crosshairs"></i>DevOps</a></li>
		  		
		  	
		  		
		  			<li><a href="/2017/07/01/Index-Software-Engineering-In-Practice/" title="設計、開發、測試、維運"><i class="fa fa-cogs"></i>軟體工程</a></li>
		  		
		  	
		  		
		  			<li><a href="/2017/07/01/Index-Management/" title="經營、管理、領導、教練、產品"><i class="fa fa-users"></i>經營管理</a></li>
		  		
		  	
		  		
		  			<li><a href="/categories/Reference/" title="參考書、名詞對照表"><i class="fa fa-folder"></i>字典工具</a></li>
		  		
		  	
			</ul>

			<!-- @ricka: menu in right -->
			<ul class='nav navbar-nav navbar-right'>
				<li class='dropdown'>
					<a aria-expanded='false' class='dropdown-toggle' data-toggle='dropdown' href='#' role='button'><i class="fa fa-folder"></i>About<span class='caret'/></span></a>
					<ul class='dropdown-menu' role='menu'>
					
						<li><a href="/2017/12/29/About/About-This-Blog/" title="About this blog" target="_blank"> <i class="fa fa-sitemap"></i>關於這裡</a></li>
					
						<li><a href="/2017/12/29/About/About-Author/" title="" target="_blank"> <i class="fa fa-user"></i>關於作者</a></li>
					
						<li><a href="/2017/09/20/About/Learning-Approaches/" title="" target="_blank"> <i class="fa fa-book"></i>學習法則</a></li>
					
						<li><a href="https://www.gtcafe.com" title="GTCafe Studio" target="_blank"> <i class="fa fa-coffee"></i>GTCafe Studio</a></li>
					
						<li><a href="https://www.gtcafe.com/rickmidi/" title="喝咖啡 聊音樂 (v2021)" target="_blank"> <i class="fa fa-music"></i>喝咖啡 聊音樂 (v2021)</a></li>
					
					</ul>
				</li>
			</ul>
			<!-- @ricka end -->
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
    <div class="content" style="background-color: white;">
       




	
		<!-- @rick, header of article -->
		<!-- original
		<div class="page-header">
			<h1> SaaS 關鍵設計 - Multi-Tenancy - 探討真實世界的租賃關係</h1>
		</div>
		-->

		<div class="panel article_title">
			<div class="panel-heading">
    		<h1> SaaS 關鍵設計 - Multi-Tenancy - 探討真實世界的租賃關係</h1>
  		</div>
		</div>

	



<div class="row post">
	<!-- cols -->
	
	<div class="col-md-9">
		

			

			<!-- content -->
			<div class="mypage">
				<!-- ref: https://developers.facebook.com/docs/plugins/like-button -->
				<!-- Facebook in front of page -->
				<!--
				<iframe
					src="https://www.facebook.com/plugins/like.php?href=https%3A%2F%2Frickhw.github.io%2F2023%2F09%2F11%2FDistributedSystems%2FSaaS-KeyDesign_MultiTenancy-with-Isolation-Factor%2F&width=450&layout=standard&action=like&size=small&show_faces=true&share=true&height=80&appId=1554905741423841"
					width="450" height="80"
					style="border:none;overflow:hidden"
					scrolling="no" frameborder="0"
					allowTransparency="true" allow="encrypted-media"></iframe>
				-->

				<!-- <div class="fb-like" data-href="https://rickhw.github.io/2023/09/11/DistributedSystems/SaaS-KeyDesign_MultiTenancy-with-Isolation-Factor/" data-layout="standard"
					data-action="like" data-size="small" data-show-faces="true" data-share="true"></div>-->

				<div class="fb-like" data-href="https://rickhw.github.io/2023/09/11/DistributedSystems/SaaS-KeyDesign_MultiTenancy-with-Isolation-Factor/" data-width="" data-layout="button_count"
					data-action="like" data-size="small" data-share="true"></div>

				<hr />

				<p><code>多租戶架構 (Mulit-Tenancy Architecture, 以下稱作 MTA)</code> 是 <code>SaaS (Software as a Service, 軟體及服務)</code> 設計的核心議題，也是我過去幾年工作研究的題目之一，大部分的人針對這個題目討論的多是 K8s 的 Namespace 劃分、或者資料庫的拆分方式、使用 Single or Shared &#x2F; Hybrid … 等策略。</p>
<p>多租戶架構背後需要討論的，除了這些技術架構的議題，更重要的是往前一步：</p>
<blockquote>
<p>SaaS 的 <code>多租戶</code> 應該怎麼定義？以及能夠解決那些問題？</p>
</blockquote>
<p>基於這些討論與實踐，最後我提出設計 MTA 的關鍵抽象概念，我把它稱為 <code>Isolation Factor (隔離因子)</code>。</p>
<p>這篇文章嘗試解釋與探討 <code>多租戶</code> 背景與核心議題，同時用真實世界的租賃關係，剖析設計 SaaS 時必須要知道的概念，嘗試帶出 Isolation Factor 的重要性。</p>
<blockquote>
<p>相關文章：</p>
<ul>
<li><a href="/2022/07/04/DistributedSystems/Inspired-Design-From-Eclipse/">摘要 Eclipse 設計的啟發：當代 SaaS 分散式架構的關鍵設計</a></li>
<li><a href="/2023/06/24/DistributedSystems/API-First_Communication-Protocol/">API 設計 - 摘要 API 通訊模式與協議</a></li>
<li><a href="/2021/05/14/DistributedSystems/Service-Governance/">聊聊分散式架構的服務治理</a></li>
</ul>
</blockquote>
<span id="more"></span>

<hr>
<h1 id="真實世界裡的租賃關係"><a href="#真實世界裡的租賃關係" class="headerlink" title="真實世界裡的租賃關係"></a>真實世界裡的租賃關係</h1><p>在真實的世界中，有幾種角色關係：</p>
<ul>
<li><code>房東 (Landlord)</code>：出租房子的人成為房東<ul>
<li>英文用詞：Landlord, Landlady</li>
<li>物件在法律上的資產擁有者，具備 <code>擁有權</code></li>
<li>對於物件有 <code>管理權</code> 以及 <code>使用權</code></li>
<li>承租合約成立區間，不具備使用權</li>
</ul>
</li>
<li><code>房客 (Lodger)</code>：指的是房子的承租者 (人) - 中文叫做 <code>租戶</code>、<code>房客</code>、<code>承租人</code>、或 <code>佃戶</code><ul>
<li>英文用詞：Lodger、Tenant</li>
<li>承租對象的是房東提供的 <code>承租物件</code></li>
<li>在雙方約定的時間範圍之內，房客 <code>具備</code> 承租物件的 <code>使用權</code></li>
<li>約定時間之內，非特定情境，房東 <code>不具備</code> 承租物件的使用權</li>
</ul>
</li>
<li><code>承租物件 (Object)</code> ：與租戶對應的房子稱為 <code>承租物件 (Object)</code>、出租處<ul>
<li>英文用詞：老美稱為 apartment、英國稱為 flat。</li>
<li>承租物件內部使用稱為使用權，物件以外稱為管理權</li>
<li>物件以外，在真實世界稱為公共空間、公共設施、公共區域 … etc.</li>
</ul>
</li>
<li><code>合約 (Rental Agreements)</code>：指房東 &#x2F; 租戶 雙方對於 承租物件 的使用權 承諾<ul>
<li>合約包含以下資訊：<ol>
<li><code>房客 (who)</code> 識別資訊，通常是個人身份、職業，目的是用來識別法律上的效益。</li>
<li>允許使用的 <code>時間範圍 (when)</code></li>
<li>對於承租物件的 <code>權利與義務 (what)</code></li>
<li>更多參閱 <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Rental_agreement">Rental agreement</a></li>
</ol>
</li>
<li>用詞：tenancy (租賃)，通常用在房屋、土地等不動產的</li>
</ul>
</li>
<li><code>承租 (Lease, v)</code>：租戶向房東簽訂使用合約，整個動作稱為 <code>承租</code></li>
<li><code>使用權</code>: 泛指承租者 (房客) 在合約期限內，對於承租物件的使用範圍，其中包含承租物件本身以及公共區域的使用權</li>
<li><code>管理權</code>: 承租物件內部與外部的管制與控制</li>
<li><code>擁有權 (Ownership)</code>: 泛指資產在法律上賦予的擁有權</li>
</ul>
<p>這些關係稱為 <code>租賃 (Tenancy)</code>，概念如下圖所示：</p>
<p><img src="/images/DistributedSystems/MultiTenancy/lodger-landlord-rental-agreement_v20230911.png"></p>
<p>了解基本租賃的幾個角色、關係之後，我想把主軸放在 <code>房東</code>、<code>承租物件</code>、<code>房客</code> 這三者的關係，然後套到的 SaaS 設計裡。</p>
<blockquote>
<p>註：雖然房客 (Lodger) 的英文也可以是 Tenant 這個字，但是實際上中文口語上描述 <code>租戶</code> 的時候，可以意指 <code>人 (房客)</code>、或者是 <code>承租物件 (Object)</code>，通常要看前後文判斷，本文會直接使用 Object 直接代表承租房子，避免語意錯置。</p>
</blockquote>
<h2 id="其他專有名詞"><a href="#其他專有名詞" class="headerlink" title="其他專有名詞"></a>其他專有名詞</h2><ul>
<li>垂直權限</li>
<li>水平權限</li>
<li>仿登入 (impersonate), 概念類似 sudo &#x2F; run as xxx</li>
<li>RBAC (Role-Based Access Control)</li>
<li>ABAC (Role-Based Access Control)</li>
</ul>
<hr>
<h1 id="背景探討：各種租賃組合"><a href="#背景探討：各種租賃組合" class="headerlink" title="背景探討：各種租賃組合"></a>背景探討：各種租賃組合</h1><h2 id="租賃關係的排列組合"><a href="#租賃關係的排列組合" class="headerlink" title="租賃關係的排列組合"></a>租賃關係的排列組合</h2><p><code>Multi-Tenancy</code> 這個字，中文翻譯成：<code>多租戶</code>，字面上看似容易理解，但在設計與實作時，卻很容易做出有問題的設計。接下用 <code>房東 (Landlord)</code>、<code>承租物件 (Object)</code>、以及 <code>房客 (Lodger)</code>，三者的數量關係，分別探討各種形式的租賃關係。</p>
<p>三個變動因子，每個變動因子都有 <code>一個</code> 或 <code>多個</code> 兩種選項，其排列組合列舉如下表：</p>
<p><img src="/images/DistributedSystems/MultiTenancy/Rental-Agreements-Matrix_v20230911.png"></p>
<p>探討過程，我會嘗試用真實世界的案例帶入，如果沒有舉例的，可能是我自己經歷不夠、想像力不足，或者是 … 排列組合根本就不合理。</p>
<p>首先先從 <code>多租戶</code> 這個詞的相對詞：<code>單一租戶 Single Tenant</code> 切入。</p>
<h2 id="Case-A-Single-Tenant"><a href="#Case-A-Single-Tenant" class="headerlink" title="Case A: Single Tenant"></a>Case A: Single Tenant</h2><p><code>Single Tenant</code> 指的是 <code>一個房東</code> 可以提供 <code>一個物件</code> 給 <code>一個房客</code> 承租 ，完成 <code>一個租賃合約</code>，這三者的關係如下圖：</p>
<p><img src="/images/DistributedSystems/MultiTenancy/CaseA_Single-Tenant_v20230911.png"></p>
<p>這三者是一對一對一的關係：</p>
<blockquote>
<p>房東：承租物件：房客 &#x3D; 1：1：1</p>
</blockquote>
<p>生活中常見的例子，像是一個大樓的 (一個) 房東，將一整棟大樓租賃給一家企業。</p>
<ul>
<li>一個房東</li>
<li>一棟大樓</li>
<li>一家企業</li>
</ul>
<h2 id="Case-B-Multiple-Tenant"><a href="#Case-B-Multiple-Tenant" class="headerlink" title="Case B: Multiple Tenant"></a>Case B: Multiple Tenant</h2><p>房東只有一個物件可以承租給房客？雖然有，但是不是普通鄉民會接觸的。</p>
<p>生活中更多的例子會是一個房東同時擁有多個物件可以出租，也就是 <code>一個房東</code> 可以提供 <code>多個物件</code> 給 <code>多個房客</code> 承租 ，完成 <code>多個租賃合約</code>，這三者的關係如下圖：</p>
<p><img src="/images/DistributedSystems/MultiTenancy/CaseB_Multiple-Tenant_v20230911.png"></p>
<p>這三者的關係是：</p>
<blockquote>
<p>房東：承租物件：房客 &#x3D; 1：N：N</p>
</blockquote>
<p>注意，這裡描述 <code>承租物件</code> 與 <code>房客</code> 兩者是一對一關係，也就是每一個物件，只承租給一個客戶。不是一個物件，承租給多個客戶，這種結構在最後會描述。</p>
<p>在真實世界的租賃中，承租物件已經具備明確的 <code>邊界 (Border)</code>，像是房屋都具備具象化的牆壁、隔間、房門等邊界，所以房內屬於私人區域、以外則公共區域，公私領域的邊界是清楚，且明確的。</p>
<p>而所謂的 <code>多租戶</code> 這個詞背後隱含的是：</p>
<blockquote>
<p>相對於房東而言，也就是我們都是站在房東角度在論述。</p>
</blockquote>
<p>這句話很重要，請留意思考的切入角度 (角色)，本文全文的論述其實都是房東角度。</p>
<h2 id="Case-C"><a href="#Case-C" class="headerlink" title="Case C"></a>Case C</h2><p>上述 <code>Case A: Single Tenant</code> 和 <code>Case B: Multiple Tenant</code> 是真實世界常見的例子，屬於正常、合理的例子。</p>
<p>接下來我們來探討第三個例子，其結構如下圖：</p>
<p><img src="/images/DistributedSystems/MultiTenancy/CaseC_Single-Landlord-Lodger_Mulitple-Objects_v20230911.png"></p>
<p>這三者關係是：</p>
<blockquote>
<p>房東：承租物件：房客 &#x3D; 1：N：1</p>
</blockquote>
<p>這個意思是，一個房東，擁有 N 個物件，但是都租給同一個房客，會有這樣的案例？現實生活中，也許有吧？不曉得 … 貧窮限制我的想像啊。。。。</p>
<h2 id="Case-D"><a href="#Case-D" class="headerlink" title="Case D"></a>Case D</h2><p>排列組合還有，繼續推演下一個狀況：</p>
<p><img src="/images/DistributedSystems/MultiTenancy/CaseD_Single-Landlord-Object_Multiple-Lodger_v20230911.png"></p>
<p>這三者關係是：</p>
<blockquote>
<p>房東：承租物件：房客 &#x3D; 1：1：N</p>
</blockquote>
<p>這個狀況的意思是：</p>
<blockquote>
<p>一個房東的其中一個物件，同時租給多個房客，背後有多個契約。</p>
</blockquote>
<p>真實案例像是青年旅館，一個大通鋪，一堆人住一個晚上。在 IT 系統裡，有點像是一家公司申請一個 AWS Account，在裡面部署一套系統，這套系統，同時租賃給多個客戶使用。</p>
<hr>
<h1 id="探討"><a href="#探討" class="headerlink" title="探討"></a>探討</h1><p>上一段整理了四個排列組合，真實世界的運作往往會比這些單一排列組合更複雜，更多的是複合式的組合。</p>
<p>我們就用這四個為基礎單位，探討真實世界的組合。</p>
<h2 id="探討一：Case-X1-x3D-Case-B-D"><a href="#探討一：Case-X1-x3D-Case-B-D" class="headerlink" title="探討一：Case X1 &#x3D; Case B + D"></a>探討一：Case X1 &#x3D; Case B + D</h2><p>上述 Case B &#x2F; D 有著很類似的概念，不過看到這裡的讀者可能腦袋也打結了 XD</p>
<p>重新整理這兩者的關係如下：</p>
<p>Case B:</p>
<blockquote>
<p>房東：承租物件：房客 &#x3D; 1：N：N</p>
</blockquote>
<p>Case D</p>
<blockquote>
<p>房東：承租物件：房客 &#x3D; 1：1：N</p>
</blockquote>
<p>把這兩個 Case 合併成 <code>Case X1</code> 如下圖：</p>
<p><img src="/images/DistributedSystems/MultiTenancy/CaseX1_B+D_v20230911.png"></p>
<p>用 AWS 的角度舉例說明，圖中的角色分別如下：</p>
<ul>
<li>Landlard: AWS</li>
<li>Object: AWS Account</li>
<li>Lodgers: AWS IAM 裡的 User</li>
</ul>
<p>這個例子，如果用過 AWS 的人應該不難理解，不過要留意的是，每個 AWS Account 裡的資源彼此是看不到彼此的，像是:</p>
<ul>
<li><code>User#A @ Object#A</code> 是無法直接跟 <code>User#A @ Object#B</code> 對話的</li>
<li><code>Object#B</code> 是無法得知 <code>Object#A</code> 裡有哪些 Users</li>
<li><code>User#A @ Object#A</code> 不等於 <code>User#A @ Object#B</code></li>
</ul>
<p>上面的描述，背後隱含的關鍵意義就是 Object 之間是 <code>隔離</code> 的，而且是強制性的隔離。</p>
<p>換 GCP 的例子：</p>
<ul>
<li>Landlard: GCP</li>
<li>Object: GCP Project</li>
<li>Lodgers: GCP Project IAM User</li>
</ul>
<p>這個也不難理解，同樣可以舉例出 Object 之間隔離的概念，也完全與 AWS 一致。</p>
<p>GCP 與 AWS 的隔離概念稱為 <code>垂直權限 (Vertical Authority)</code></p>
<p>繼續下一個例子是 K8s:</p>
<ul>
<li>Landlard: K8s Cluster</li>
<li>Object: by Namespace</li>
<li>Lodgers: Application or Developer</li>
</ul>
<p>K8s 開始出現一個狀況，所謂的 Namespace 只是邏輯概念切割，也就是資源之間的並不是 <code>強隔離</code>。</p>
<h2 id="探討二：二房東-Case-X2"><a href="#探討二：二房東-Case-X2" class="headerlink" title="探討二：二房東 Case X2"></a>探討二：二房東 Case X2</h2><p>上述 Case E 用 AWS &#x2F; GCP &#x2F; K8s 當例子，但更多時候企業在發展自己的業務狀況會是這樣：</p>
<p><img src="/images/DistributedSystems/MultiTenancy/CaseX2_B+B_v20230911.png"></p>
<p>把 <code>Object#A</code> 拆分，自己變成二房東，租一個物件，但是這個物件拆分成 N 個，每個再租給其他的使用者。</p>
<p>而如何把 Object#A 拆分的好與壞，就在於隔離的實作。</p>
<p>前面提到在真實世界的租賃中，承租物件已經具備明確的 <code>邊界 (Border)</code>，但是承租 AWS 的企業，又把這個 SaaS 承租給他們的客戶，而對於 SaaS 客戶而言，邊界應該、必須要存在，而這個邊界則需要由 SaaS 公司在架構設計時，必須自己建立一道讓客戶以為的邊界，這個邊界，在本文中稱為 <code>隔離 (Isolation)</code>。</p>
<h2 id="隔離的核心議題-Isolation-Factor-隔離因子"><a href="#隔離的核心議題-Isolation-Factor-隔離因子" class="headerlink" title="隔離的核心議題: Isolation Factor (隔離因子)"></a>隔離的核心議題: Isolation Factor (隔離因子)</h2><p>本質上來講，隔離是透過一種 <code>邊界 (Boundary)</code> 方式，區分租戶彼此之間的空間範圍。</p>
<p>房子來講，區分彼此的空間範圍就是樑柱、牆壁、門、地板、天花板 … 等；以企業內部來講，就是各種辦公室的實體隔間、以及特定角色授權；以應用程式來說，就是使用者 A 能否看到使用 B 的資料而言。依照這樣的隔離概念，底下這些都是犯規：</p>
<ul>
<li>企業大樓裡，未經授權的員工，進入機房</li>
<li>企業員工在 AWS 上開台機器，沒有認證授權，方便自己進出公司網域</li>
<li>SRE 說：我的 Gmail 看到別人的信，就要把 Gmail shutdown! –&gt; <a target="_blank" rel="noopener" href="https://www.ithome.com.tw/news/105366">相關報導</a></li>
<li>薩爾達傳說 - 王國之淚: 看我通天術 (這嚴重犯規 XDD)<br><img src="/images/DistributedSystems/MultiTenancy/zelda-totk.jpeg"></li>
</ul>
<h3 id="實體隔離與邏輯隔離"><a href="#實體隔離與邏輯隔離" class="headerlink" title="實體隔離與邏輯隔離"></a>實體隔離與邏輯隔離</h3><p>在商業應用程式裡，隔離則因為 <code>領域 (Domains)</code> 不同，會用不同的方式，商業應用角度多半會以 <code>邏輯隔離</code> 為主。</p>
<p>邏輯隔離的例子，舉例常見的概念：</p>
<ul>
<li>Google 服務 (Gmail &#x2F; Gmap &#x2F; Docs …) 都是以 Gmail Account 為隔離單位</li>
<li>GCP 以 Project 為隔離單位</li>
<li>AWS 則以 Account 為單位</li>
<li>Chrome 這個瀏覽器則以 Profile 為隔離概念</li>
<li>多租戶架構的電商平台，隔離則是以 <code>店</code> 為單位，像是 91APP 是開店平台</li>
<li>教育平台，則是以學校為單位，像是 <a target="_blank" rel="noopener" href="https://teachable.com/">Teachable</a> 這個平台<ul>
<li>開學校之後，每個學校都可以有自己的學生、自己的老師 .. 等角色定義</li>
</ul>
</li>
<li>作業系統的隔離：Linux 的系統權限 user-group-anyone 本質上就是種隔離</li>
<li>資料庫的隔離：Database &#x2F; Table &#x2F; Row 都是隔離概念，更甚者則是交易過程的鎖。</li>
</ul>
<p>上述的隔離，在權限系統稱為 <code>垂直權限</code>，也就是透過 <code>帳號 (通常)</code> 隔離彼此。除了垂直權限，相對則是 <code>水平權限</code>，概念如下圖：</p>
<p><img src="/images/DistributedSystems/MultiTenancy/SaaS-Multi-Tenancy-Permission-Design_v20230911.png"></p>
<p>但是當業務發展到一定程度之後，或者依照法規的需求，則很常會以期望實體隔離，也就是在實體的系統架構，就是 <code>專用 (Dedicated)</code> 資源，不與其他人共用。<br>不管是實體還是邏輯隔離，都需要一個關鍵因子來定義怎麼隔離？而這個隔離的關鍵因子我把它稱為 <code>隔離因子 (Isolation Factor)</code></p>
<p>前面描述的手段與方法都是為了達到隔離：</p>
<ul>
<li>權限：多租戶架構常用的方法是 <code>垂直權限</code><ul>
<li>相對於垂直權限，稱為 <code>水平權限</code>，實踐方式有 RBAC、ABAC</li>
</ul>
</li>
<li>實體隔離 (physical isolation)</li>
<li>邏輯隔離 (logical isolation): 虛擬化 virtualization, VPC</li>
</ul>
<h3 id="AWS-服務的隔離因子"><a href="#AWS-服務的隔離因子" class="headerlink" title="AWS 服務的隔離因子"></a>AWS 服務的隔離因子</h3><p>AWS 有很多服務，舉凡 EC2 &#x2F; S3 &#x2F; DynamoDB &#x2F; CloudFront … etc. 這些服務在 AWS 裏面都需要計算隔離方式，但是每個服務本身的屬性不一樣，在設計的時候怎麼知道每個服務的隔離因子是什麼？底下列舉設計 AWS 服務要考慮的隔離因子：</p>
<ul>
<li>EC2: Instance</li>
<li>S3: Bucket</li>
<li>DynamoDB: Table</li>
<li>CloudFront: Distribution</li>
<li>VPC 本身就是個隔離單位</li>
</ul>
<p>上述列舉的是這些服務的隔離因子例子，因為每個服務特性有所差異，要對應到 AWS Account 時，就要具體用一個單位對應隔離的想法，不然就會無法對應。</p>
<h2 id="隔離沒做好會怎樣？"><a href="#隔離沒做好會怎樣？" class="headerlink" title="隔離沒做好會怎樣？"></a>隔離沒做好會怎樣？</h2><p>這是隔離背後要解決的關鍵痛點，最經典的案例是下圖：</p>
<p><img src="/images/DistributedSystems/MultiTenancy/20160421_SRE.png"><br>Source: <a target="_blank" rel="noopener" href="https://www.ithome.com.tw/news/105366">Google儲存SRE團隊負責人第一手經驗大公開</a>, by ITHome, 20160421</p>
<p>另一個經典案例則是 VPC 的問題，底下截圖則是中國知名技術專家 <a target="_blank" rel="noopener" href="https://coolshell.me/">陳皓</a> 的部落格：</p>
<p><img src="/images/DistributedSystems/MultiTenancy/20200419_AliyunVPC.png"><br>Source: <a target="_blank" rel="noopener" href="https://www.ithome.com.tw/news/105366">关于阿里云经典网络的问题</a>, by Coolshell, 20200419</p>
<p>這都是別人的問題，而我面對過的問題則是之前在電商工作時，曾經出現的問題，我把它稱為 <code>A-c-B event</code>，中文稱為 <code>A 店跨 B 店</code>。也就是 B 店的使用者，看到 A 店的資料，不管是商品資料、還是訂單資料。</p>
<p>這三個例子，資安角度都是 <code>垂直權限</code> 的問題，背後實際問題就是隔離的設計與實踐。</p>
<blockquote>
<p>updated 2023&#x2F;09&#x2F;29: 最近發生的 <a target="_blank" rel="noopener" href="https://www.ithome.com.tw/news/159045">Google Bard臭蟲讓用戶對話出現在公開Google搜尋結果中</a> 也屬於隔離沒做好造成的。</p>
</blockquote>
<h2 id="跨租戶問題常見的做法"><a href="#跨租戶問題常見的做法" class="headerlink" title="跨租戶問題常見的做法"></a>跨租戶問題常見的做法</h2><p>雖然說跨租戶是不允許的，但是生活中還是有很多場景，需要跨租戶存取，例如我們信用卡掛失的時候，客服人員可以幫你調整信用卡的狀態。客服人員代替你調整信用卡的過程，就是個跨租戶操作，不管怎樣他要操作設定的時候，都要獲得你的允許，然後才能幫你調整狀態。這樣的過程，其實就是個身份暫時轉換，代理 (delegate) 執行的過程。</p>
<p>類似的做法，在作業系統已經都有很成熟的做法：</p>
<ul>
<li>Linux: sudo as XXX</li>
<li>Windows: Run as XXXX</li>
</ul>
<p>在系統實作時，專有名詞為 <code>impersonate (v)</code>，也就是 <code>User#A@Tanent#A as User#B@Tenant#B</code>，這是個需要授權程序的。</p>
<p>在 AWS 的設計，幾種常見的例子：</p>
<ul>
<li>當 Account#A 要存取 Account#B 得時候，可以透過 STS 取得臨時授權</li>
<li>當網路要相互連線時，需要透過雙方授權才能連結，像是 VPC Peering</li>
</ul>
<!--
多租戶重點？
在單一使用者個人電腦作業系統，Kernel Space / User Space 可以類似於這樣的概念。

- Isolation for What?
- Multi-tenant Application (MTA)
- Multi-instance Solution (MIS)



## Isolation 的層次

- Application Resource (VM)
- Data Isolation
    - Database
    - Storage
    - Shared Isolation:
    - ref
        - https://oncodedesign.com/data-isolation-and-sharing-in-multitenant-system-part1/
        - https://oncodedesign.com/data-isolation-and-sharing-in-multitenant-system-part2/
        - https://oncodedesign.com/data-isolation-and-sharing-in-multitenant-system-part3/

## 常見的問題

底下問題是跟不同人討論過程，發現對於 Multi-tenancy 的理解上，常見的提問。

### Q: Tenant#A 裡的 User#A 跟 Tenant#B 裡的 User#A 是否同一個人？

-->


<hr>
<h1 id="小結"><a href="#小結" class="headerlink" title="小結"></a>小結</h1><p>下圖是一張網路梗圖：</p>
<p><img src="/images/DistributedSystems/MultiTenancy/Multiple-Windows.jpg"><br>Source: <a target="_blank" rel="noopener" href="https://www.facebook.com/groups/it.humor.and.memes/posts/24452121121053675/">https://www.facebook.com/groups/it.humor.and.memes/posts/24452121121053675/</a></p>
<p>圖中在 Windows 裡裝了 VMWare，然後裡面裝了 Windows，裡面再裝 VMWare … 如此好幾層 … 這張圖表述了多租戶的核心概念，不過大家知道 VM 本身是模擬硬體，換言之實作的是實體隔離。相對於 VM 則是 Container，透過 Kernal 的特性 (cgroup, namespace … etc)，時做出隔離的概念。</p>
<p>而應用程式如果要做出隔離概念，則必定要面對如何定義租戶的概念，租戶本質就是為了達到隔離，用來隔離的 <code>隔離因子 (Isolation Factor)</code>，則是本文想帶出的概念。</p>
<p>多租戶架構因而衍生的相關議題：</p>
<ol>
<li>水平權限系統，像是 RBAC &#x2F; ABAC，也就是 AWS IAM<ul>
<li>衍生的則是 API 認證授權與通訊協議，相關參閱 <a href="/2023/06/24/DistributedSystems/API-First_Communication-Protocol/">API 設計 - 摘要 API 通訊模式與協議</a></li>
</ul>
</li>
<li>租戶與 <code>功能</code> 的訂閱市集 (Marketplace)，背後本質是個 Pub&#x2F;Sub 概念<ul>
<li>相關參閱 <a href="/2022/07/04/DistributedSystems/Inspired-Design-From-Eclipse/">摘要 Eclipse 設計的啟發：當代 SaaS 分散式架構的關鍵設計</a></li>
</ul>
</li>
<li>帳務系統：延續租戶與功能訂閱而產生的議題，也就是使用狀況 (Usage) 與帳務資訊 (Billing)</li>
<li>功能系統的通訊架構，相關參閱 <a href="/2022/07/04/DistributedSystems/Inspired-Design-From-Eclipse/">摘要 Eclipse 設計的啟發：當代 SaaS 分散式架構的關鍵設計</a></li>
</ol>
<!--
source: https://docs.google.com/presentation/d/1tPPkhBHIdGeWC7He4782rzwIr7SFr8VCBNrT50Wjwng/edit#slide=id.p
-->


<hr>
<h1 id="延伸閱讀"><a href="#延伸閱讀" class="headerlink" title="延伸閱讀"></a>延伸閱讀</h1><h2 id="站內文章"><a href="#站內文章" class="headerlink" title="站內文章"></a>站內文章</h2><ul>
<li><a href="/2022/07/04/DistributedSystems/Inspired-Design-From-Eclipse/">摘要 Eclipse 設計的啟發：當代 SaaS 分散式架構的關鍵設計</a></li>
<li><a href="/2023/06/24/DistributedSystems/API-First_Communication-Protocol/">API 設計 - 摘要 API 通訊模式與協議</a></li>
<li><a href="/2021/05/14/DistributedSystems/Service-Governance/">聊聊分散式架構的服務治理</a></li>
</ul>
<h2 id="參考資料"><a href="#參考資料" class="headerlink" title="參考資料"></a>參考資料</h2><ul>
<li><a target="_blank" rel="noopener" href="http://en.wikipedia.org/wiki/Multitenancy">Multitenancy</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.arkency.com/comparison-of-approaches-to-multitenancy-in-rails-apps/">Comparison of approaches to multitenancy in Rails apps</a></li>
<li><a target="_blank" rel="noopener" href="https://cloud.google.com/kubernetes-engine/docs/best-practices/enterprise-multitenancy">Best practices for enterprise multi-tenancy</a> - GKE</li>
<li>General Design Concepts<ul>
<li><a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/azure-sql/database/saas-tenancy-app-design-patterns?view=azuresql">Multi-tenant SaaS database tenancy patterns</a> - Azure, 20230304</li>
<li><a target="_blank" rel="noopener" href="https://www.nagarro.com/en/blog/multi-tenant-saas-application-architecture">Architecting a typical Multi-tenant SaaS Application – All you need to know</a></li>
<li><a target="_blank" rel="noopener" href="https://web.archive.org/web/20150221181153/http://se2.informatik.uni-wuerzburg.de/pa/uploads/papers/paper-371.pdf">Architectural Concerns in Multi-Tenant SaaS Applications</a></li>
<li><a target="_blank" rel="noopener" href="https://www.forbes.com/sites/forbesbusinesscouncil/2019/11/20/what-is-the-saas-architecture-maturity-model/?sh=4196006c4b40">What Is The SaaS Architecture Maturity Model?</a></li>
</ul>
</li>
<li>K8s 相關<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/kubernetes-sigs/multi-tenancy">K8s Multi-tenancy 小組</a></li>
<li><a target="_blank" rel="noopener" href="https://kubernetes.io/blog/2021/04/15/three-tenancy-models-for-kubernetes/">Three Tenancy Models For Kubernetes</a></li>
<li><a target="_blank" rel="noopener" href="https://thenewstack.io/designing-a-multitenancy-kubernetes-strategy-that-fits-your-organization/">Designing a Multitenancy Kubernetes Strategy that Fits Your Organization</a></li>
</ul>
</li>
<li>資料庫相關<ul>
<li><a target="_blank" rel="noopener" href="https://vladmihalcea.com/database-multitenancy/">A beginner’s guide to database multitenancy</a>, 20200917</li>
<li><a target="_blank" rel="noopener" href="https://oncodedesign.com/data-isolation-and-sharing-in-multitenant-system-part1/">Data Isolation and Sharing in a Multitenant System - Part 1</a></li>
<li><a target="_blank" rel="noopener" href="https://oncodedesign.com/data-isolation-and-sharing-in-multitenant-system-part1/">Data Isolation and Sharing in a Multitenant System - Part 2</a></li>
<li><a target="_blank" rel="noopener" href="https://oncodedesign.com/data-isolation-and-sharing-in-multitenant-system-part1/">Data Isolation and Sharing in a Multitenant System - Part 3</a></li>
</ul>
</li>
<li>AWS<ul>
<li><a target="_blank" rel="noopener" href="https://www.nagarro.com/en/blog/architectural-design-patterns-aws-multi-tenancy">Architectural design patterns for multi-tenancy on AWS</a></li>
<li><a target="_blank" rel="noopener" href="https://aws.amazon.com/blogs/machine-learning/configure-amazon-forecast-for-a-multi-tenant-saas-application/">Configure Amazon Forecast for a multi-tenant SaaS application</a> - AWS Machine Learning Blog, 20210325</li>
<li><a target="_blank" rel="noopener" href="https://aws.amazon.com/blogs/security/how-to-implement-saas-tenant-isolation-with-abac-and-aws-iam/">How to implement SaaS tenant isolation with ABAC and AWS IAM</a> - AWS Security Blog, 20210609</li>
<li><a target="_blank" rel="noopener" href="https://aws.amazon.com/tw/blogs/storage/ten-tips-for-multi-tenant-multi-region-object-replication-in-amazon-s3/">Ten tips for multi-tenant, multi-Region object replication in Amazon S3</a> - AWS Storage Blog, 20211101</li>
<li><a target="_blank" rel="noopener" href="https://aws.amazon.com/blogs/database/build-and-load-test-a-multi-tenant-saas-database-proxy-solution-with-amazon-rds-proxy/">Build and load test a multi-tenant SaaS database proxy solution with Amazon RDS Proxy</a> - AWS Database Blog, 20211113</li>
<li><a target="_blank" rel="noopener" href="https://aws.amazon.com/cn/blogs/china/saas-architecture-design-on-amazon-cloud-technology-marketplace-how-to-support-multiple-products-using-a-single-account-center/">在亚马逊云科技Marketplace上的SaaS架构设计——如何支持多产品使用单一账户中心</a> - 20210813</li>
<li><a target="_blank" rel="noopener" href="https://aws.amazon.com/blogs/apn/isolating-saas-tenants-with-dynamically-generated-iam-policies/">Isolating SaaS Tenants with Dynamically Generated IAM Policies</a> - AWS Partner Network (APN) Blog, 20200921</li>
<li><a target="_blank" rel="noopener" href="https://theburningmonk.com/2021/03/how-to-secure-multi-tenant-applications-with-appsync-and-cognito/">How to secure multi-tenant applications with AppSync and Cognito</a></li>
</ul>
</li>
</ul>


				<hr />

				<!-- Facebook in bend of page -->
				<div class="fb-like" data-href="https://rickhw.github.io/2023/09/11/DistributedSystems/SaaS-KeyDesign_MultiTenancy-with-Isolation-Factor/" data-width="" data-layout="button_count"
					data-action="like" data-size="small" data-share="true"></div>

				<hr />

				<!-- LikeCoin -->
				<!-- @rickd 2022/09/06 -->
				<!--
				<iframe data-v-b66e9a5a=""
					src="https://button.like.co/in/embed/rick_kyhwang/button?referrer=https://rickhw.github.io/2023/09/11/DistributedSystems/SaaS-KeyDesign_MultiTenancy-with-Isolation-Factor/"
					frameborder="0" class="lc-margin-top-64 lc-margin-bottom-32 lc-mobile">
				</iframe>
				<br />
				-->

				<div>
					<center>
						
<div class="pagination">
<ul class="pagination">
	 
				
    	<li class="prev"><a href="/2024/03/16/Data/Data-Backup-And-Recovery-Principles-1-DataTier/" class="alignleft prev"><i class="fa fa-arrow-circle-o-left"></i>Prev</a></li>
  		

        <li><a href="/categories"><i class="fa fa-archive"></i>Archive</a></li>

		
		   <li class="next"><a href="/2023/09/09/Management/Career/2023-AWS-Career-Exploration-Day/" class="alignright next">Next<i class="fa fa-arrow-circle-o-right"></i></a></li>         
        
	
</ul>
</div>

					</center>
				</div>


				<!-- comment -->
				
<section id="comment">
  <h2 class="title">Comments</h2>

	<!-- @rick add for facebook -->
	<!-- <div class='fb-comments' data-num-posts='10' data-width='100%' expr:href='data:post.url'/> -->
  <!-- @ricka 2022/09/06, ref: https://developers.facebook.com/docs/plugins/comments/ -->
  <div class="fb-comments" data-order-by="reverse-time" data-href="https://rickhw.github.io/2023/09/11/DistributedSystems/SaaS-KeyDesign_MultiTenancy-with-Isolation-Factor/" data-width="100%" data-numposts="10"></div>

  


</section>






			</div>



		</div> <!-- col-md-9/col-md-12 -->

		
		<!-- meta in right -->
		<div class="col-md-3">

	<!-- date -->
	
	<div class="meta-widget">
		<i class="fa fa-clock-o"></i>
		2023/09/11 22:30:00
	</div>
	

	<hr />

	<!-- toc -->
	<div class="meta-widget">
	
	   <a data-toggle="collapse" data-target="#toc"><i class="fa fa-bars"></i> Table of Content</a>
	   <div id="toc" class="toc collapse in">
				<ol class="toc-article"><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#%E7%9C%9F%E5%AF%A6%E4%B8%96%E7%95%8C%E8%A3%A1%E7%9A%84%E7%A7%9F%E8%B3%83%E9%97%9C%E4%BF%82"><span class="toc-article-text">真實世界裡的租賃關係</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#%E5%85%B6%E4%BB%96%E5%B0%88%E6%9C%89%E5%90%8D%E8%A9%9E"><span class="toc-article-text">其他專有名詞</span></a></li></ol></li><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#%E8%83%8C%E6%99%AF%E6%8E%A2%E8%A8%8E%EF%BC%9A%E5%90%84%E7%A8%AE%E7%A7%9F%E8%B3%83%E7%B5%84%E5%90%88"><span class="toc-article-text">背景探討：各種租賃組合</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#%E7%A7%9F%E8%B3%83%E9%97%9C%E4%BF%82%E7%9A%84%E6%8E%92%E5%88%97%E7%B5%84%E5%90%88"><span class="toc-article-text">租賃關係的排列組合</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Case-A-Single-Tenant"><span class="toc-article-text">Case A: Single Tenant</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Case-B-Multiple-Tenant"><span class="toc-article-text">Case B: Multiple Tenant</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Case-C"><span class="toc-article-text">Case C</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Case-D"><span class="toc-article-text">Case D</span></a></li></ol></li><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#%E6%8E%A2%E8%A8%8E"><span class="toc-article-text">探討</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#%E6%8E%A2%E8%A8%8E%E4%B8%80%EF%BC%9ACase-X1-x3D-Case-B-D"><span class="toc-article-text">探討一：Case X1 &#x3D; Case B + D</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#%E6%8E%A2%E8%A8%8E%E4%BA%8C%EF%BC%9A%E4%BA%8C%E6%88%BF%E6%9D%B1-Case-X2"><span class="toc-article-text">探討二：二房東 Case X2</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#%E9%9A%94%E9%9B%A2%E7%9A%84%E6%A0%B8%E5%BF%83%E8%AD%B0%E9%A1%8C-Isolation-Factor-%E9%9A%94%E9%9B%A2%E5%9B%A0%E5%AD%90"><span class="toc-article-text">隔離的核心議題: Isolation Factor (隔離因子)</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#%E5%AF%A6%E9%AB%94%E9%9A%94%E9%9B%A2%E8%88%87%E9%82%8F%E8%BC%AF%E9%9A%94%E9%9B%A2"><span class="toc-article-text">實體隔離與邏輯隔離</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#AWS-%E6%9C%8D%E5%8B%99%E7%9A%84%E9%9A%94%E9%9B%A2%E5%9B%A0%E5%AD%90"><span class="toc-article-text">AWS 服務的隔離因子</span></a></li></ol></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#%E9%9A%94%E9%9B%A2%E6%B2%92%E5%81%9A%E5%A5%BD%E6%9C%83%E6%80%8E%E6%A8%A3%EF%BC%9F"><span class="toc-article-text">隔離沒做好會怎樣？</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#%E8%B7%A8%E7%A7%9F%E6%88%B6%E5%95%8F%E9%A1%8C%E5%B8%B8%E8%A6%8B%E7%9A%84%E5%81%9A%E6%B3%95"><span class="toc-article-text">跨租戶問題常見的做法</span></a></li></ol></li><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#%E5%B0%8F%E7%B5%90"><span class="toc-article-text">小結</span></a></li><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#%E5%BB%B6%E4%BC%B8%E9%96%B1%E8%AE%80"><span class="toc-article-text">延伸閱讀</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#%E7%AB%99%E5%85%A7%E6%96%87%E7%AB%A0"><span class="toc-article-text">站內文章</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#%E5%8F%83%E8%80%83%E8%B3%87%E6%96%99"><span class="toc-article-text">參考資料</span></a></li></ol></li></ol>
		</div>
	
	</div>

	<hr />

	<!-- categories -->
  
	<div class="meta-widget">
		<a data-toggle="collapse" data-target="#categorys"><i class="fa fa-folder"></i> Categories</a>
    <!--<ul id="categorys" class="tag_box list-unstyled collapse in">-->
      <div>
  <!--<li>-->
    <span class="label label-info"><a href="/categories/Distributed-Systems/" style="color: white">Distributed Systems <span class="badge">20</span></a></span>
  <!--</li>-->
</div>
    <!--</ul>-->
	</div>
	

	<hr />

	<!-- tags -->
	
	<div class="meta-widget">
		<a data-toggle="collapse" data-target="#tags"><i class="fa fa-tags"> Tags</i></a>
    <!--<ul id="tags" class="tag_box list-unstyled collapse in">-->
    <div>
	  	
  <span class="label label-success"><a href="/tags/Distributed-Systems/" style="color: white">Distributed Systems <span class="badge">16</span></a></span> <span class="label label-success"><a href="/tags/Design-Thinking/" style="color: white">Design Thinking <span class="badge">2</span></a></span> <span class="label label-success"><a href="/tags/Multi-Tenancy/" style="color: white">Multi-Tenancy <span class="badge">2</span></a></span> <span class="label label-success"><a href="/tags/SaaS/" style="color: white">SaaS <span class="badge">2</span></a></span> <span class="label label-success"><a href="/tags/Isolation-Factor/" style="color: white">Isolation Factor <span class="badge">2</span></a></span> <span class="label label-success"><a href="/tags/Multi-Tenancy-Architecture/" style="color: white">Multi-Tenancy Architecture <span class="badge">1</span></a></span> <span class="label label-success"><a href="/tags/RBAC/" style="color: white">RBAC <span class="badge">1</span></a></span> <span class="label label-success"><a href="/tags/Authorization/" style="color: white">Authorization <span class="badge">1</span></a></span>
	  </div>
    <!--</ul>-->
	</div>
	


  <hr />

	<div class="meta-widget">
		<!-- v4 -->
		<h4>About</h4>
		
			<li><a href="/2035/01/21/Index/">全站索引</a></li>
		
			<li><a href="/2017/12/29/About/About-This-Blog/">關於這裏</a></li>
		
			<li><a href="/2017/12/29/About/About-Author/">關於作者</a></li>
		
			<li><a href="/2017/09/20/About/Learning-Approaches/">學習法則</a></li>
		
			<li><a href="/2017/11/26/Thinking-in-Essence/">思考本質</a></li>
		
			<li><a href="/2017/12/02/About/Epiphany/">一些領悟</a></li>
		
			<li><a href="/2014/10/26/Management/Classified-Philosophy/">分類哲學</a></li>
		

		<h4>著作</h4>
		
			<li><a href="/2023/07/17/About/2023-SRE-Practice-and-IDP/">個人著作：SRE實踐與開發平台指南</a></li>
		
			<li><a href="/2023/05/23/About/2023-Software-Test-Practice/">共同著作：軟體測試實務 (2023)</a></li>
		
			<li><a href="/2019/05/17/About/DDS-zh_TW/">譯著：分散式系統設計 (2019)</a></li>
		

		<h4>演講</h4>
		
			<li><a target="_blank" rel="noopener" href="https://www.youtube.com/playlist?list=PL63J1r2PBvoiKFC40HTdSrGSQVBqOutOf">演講錄影 @ Youtube</a></li>
		
			<li><a href="/2023/09/09/About/2023-AWS-Career-Exploration-Day/">探索職涯、複利人生 - AWS Career Exploration Day 2023</a></li>
		
			<li><a href="/2023/07/17/About/2023-SRE-Practice-and-IDP/">個人著作 SRE 書友見面會</a></li>
		
			<li><a href="/2023/05/23/About/2023-Software-Test-Practice/">軟體測試實務 - 新書發表會</a></li>
		
			<li><a href="/2022/12/21/About/2022-AWS-Career-Exploration-Day/">探索職涯、成就未來 - AWS Career Exploration Day 2022</a></li>
		
			<li><a href="/2022/08/13/SQA/Path-to-Software-Testing/">從理想、到現實的距離，開啟品味軟體測試之路</a></li>
		
			<li><a href="/2022/05/10/About/2022-SREConf2022/">91APP 在 AWS 上的 SRE 實踐之路</a></li>
		
			<li><a target="_blank" rel="noopener" href="https://www.slideshare.net/rickhwang/2020-aws-summit-aws">在矩陣型組織裡，如何有效管理 AWS 的成本結構與系統架構</a></li>
		
			<li><a target="_blank" rel="noopener" href="https://www.slideshare.net/rickhwang/aws-using-aws-for-disaster-recovery/">災難演練 @ AWS 實戰分享</a></li>
		
			<li><a href="/2019/04/27/DevOps/Introduce-to-Continuous-Delivery-2/">導讀持續交付 2.0 - 談當代軟體交付之虛實融合</a></li>
		
			<li><a href="/2019/03/28/DevOps/DevOpsTaiwan-Meetup-Beginning-in-Artifacts-Management/">聊聊軟體交付的濫觴 談產出物管理</a></li>
		
			<li><a href="/2018/09/12/DevOps/DevOpsDaysTaipei2018-Emergency-And-Incident-Management/">從緊急事件 談 SRE 應變能力的培養</a></li>
		
			<li><a href="/2018/07/18/About/20180718-API-Gateway/">邁向 API 經濟 - API Gateway 導入之旅</a></li>
		
			<li><a href="/2018/05/26/About/201805-Monitoring-Tools-CloudWatch/">Monitoring Tools 大亂鬥 - AWS CloudWatch</a></li>
		
			<li><a href="/2018/03/29/About/2018-Serverless-All-Star/">Ops as Code using Serverless</a></li>
		
			<li><a href="/2017/06/21/AWS/Stategies-System-Monitor_and_CloudWatch/">淺談系統監控與 CloudWatch 的應用</a></li>
		

		<!-- v3 -->
		<!--
		<li><a href="/2018/07/08/Index/">部落格索引</a></li>
		<li><a href="/2017/12/29/About/About-This-Blog/">關於這個部落格</a></li>
		<li><a href="/2017/12/29/About/About-Author/">關於作者</a></li>
		<li><a href="/2017/09/20/About/Learning-Approaches/">學習法則</a></li>
		<li><a href="/2014/12/27/Management/經營之道/">經營之道</a></li>
		<li><a href="/2017/12/02/About/Epiphany/">一些領悟</a></li>
		-->

		<!-- v2 -->
		<!-- <a href="/2017/07/01/Management/Developer-or-Engineer/">軟體開發者 (Software Developer)</a>、<a target="_blank" rel="noopener" href="http://rickmidi.blogspot.com/">音樂愛好者</a>，工作角色經歷 DevOps 三個圈圈職務: Dev / <a href="/categories/軟體測試/">QA</a> / <a href="/categories/DevOps/">Ops</a>。這幾年專注在經營管理、<a href="/2016/10/01/AWS-Study-Roadmap/">AWS</a> / GCP、分散式架構、<a href="/categories/DevOps/">維運、DevOps / SRE</a> 等領域，並活躍於各大社群的活動、演講，著有技術部落格：<a href="https://rickhw.github.io/">Complete Think</a>。工作之外也是業餘音樂愛好者，專注在 吉他、鍵盤、編曲、教學，著有音樂部落格：<a target="_blank" rel="noopener" href="https://rickmidi.blogspot.com/">喝咖啡聊音樂</a>。 -->

		<!-- v1 -->
		<!--
		<li>Software Developer</li>
		<li><a href="/categories/軟體測試/">SQA Manager</a></li>
		<li><a href="/categories/DevOps/">Operation Manager</a></li>
		<li><a target="_blank" rel="noopener" href="http://rickmidi.blogspot.com/">Musician and Guitarist</a></li>
		<li>
			<ol>
				<li>Management</li>
				<li>Cloud / Distributed Systems</li>
				<li>DevOps / SRE / </li>
			</ol>
		</li>
		-->

		<!--
		<h4>Donate</h4>
		<form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
		<input type="hidden" name="cmd" value="_s-xclick" />
		<input type="hidden" name="hosted_button_id" value="UUMSV7TXWT2AJ" />
		<input type="image" src="https://www.paypalobjects.com/en_US/TW/i/btn/btn_donateCC_LG.gif" border="0" name="submit" title="PayPal - The safer, easier way to pay online!" alt="Donate with PayPal button" />
		<img alt="" border="0" src="https://www.paypal.com/en_TW/i/scr/pixel.gif" width="1" height="1" />
		</form>
		-->

		<h4>Facebook</h4>

		<div class="fb-page" data-href="https://www.facebook.com/completethink/" data-tabs="timeline" data-small-header="false" data-adapt-container-width="true" data-hide-cover="false" data-show-facepile="true"><blockquote cite="https://www.facebook.com/completethink/" class="fb-xfbml-parse-ignore"><a target="_blank" rel="noopener" href="https://www.facebook.com/completethink/">Complete Think</a></blockquote></div>

		<a target="_blank" rel="noopener" href="https://aws.amazon.com/developer/community/heroes/rick-hwang/"><img
				src="/images/About/AWS-Hero/community-heroes_logo.png"></a>

		<h4>AWS Certifications</h4>
		<a href="/2016/04/22/AWS/AWS-Certified-Solutions-Architect_Associate/"><img src="/images/About/Solutions_Architect-Associate.jpg"></a>
		<a href="/2016/07/29/AWS/AWS-Certified-SysOps-Administrator/"><img src="/images/About/SysOps-Administrator-Associate.png"></a>
		<a href="/2016/08/20/AWS/AWS-Certified-Developer/"><img src="/images/About/Developer-Associate.png"></a>
	</div>

	<hr />
</div><!-- col-md-3 -->

		

	</div><!-- row -->


    </div>
  </div>


<div class="container-narrow">
    <footer> <p>
  &copy; 2015-2022 Rick Hwang
  
      with help from <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="http://getbootstrap.com/" target="_blank">Twitter Bootstrap</a>. Theme base on <a target="_blank" rel="noopener" href="http://github.com/wzpan/hexo-theme-freemind/">Freemind</a>.
</p> </footer>
</div>

<!-- container-narrow -->

<div id="gotop">

  <!-- 
    <i class="fa fa-sitemap"></i> <a href="/2017/12/29/About/About-This-Blog/" title="About this blog" target="_blank"]);">關於這裡</a><br />
  
    <i class="fa fa-user"></i> <a href="/2017/12/29/About/About-Author/" title="" target="_blank"]);">關於作者</a><br />
  
    <i class="fa fa-book"></i> <a href="/2017/09/20/About/Learning-Approaches/" title="" target="_blank"]);">學習法則</a><br />
  
    <i class="fa fa-coffee"></i> <a href="https://www.gtcafe.com" title="GTCafe Studio" target="_blank"]);">GTCafe Studio</a><br />
  
    <i class="fa fa-music"></i> <a href="https://www.gtcafe.com/rickmidi/" title="喝咖啡 聊音樂 (v2021)" target="_blank"]);">喝咖啡 聊音樂 (v2021)</a><br />
   -->

  <!-- <h4>About</h4> -->

  
    <li><a href="/2035/01/21/Index/">全站索引</a></li>
  
    <li><a href="/2017/12/29/About/About-This-Blog/">關於這裏</a></li>
  
    <li><a href="/2017/12/29/About/About-Author/">關於作者</a></li>
  
    <li><a href="/2017/09/20/About/Learning-Approaches/">學習法則</a></li>
  
    <li><a href="/2017/11/26/Thinking-in-Essence/">思考本質</a></li>
  
    <li><a href="/2017/12/02/About/Epiphany/">一些領悟</a></li>
  
    <li><a href="/2014/10/26/Management/Classified-Philosophy/">分類哲學</a></li>
  

  <a href="#">▲ TOP ▲ </a>
</div>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/gtcafe-tracking.js"></script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>

<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);

// GTCafe API: completet
tracking_update();
</script>



</body>
</html>
